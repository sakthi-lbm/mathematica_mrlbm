(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[      8682,        234]
NotebookOptionsPosition[      7857,        213]
NotebookOutlinePosition[      8221,        229]
CellTagsIndexPosition[      8178,        226]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"p", "[", "i_", "]"}], ":=", 
   RowBox[{"pop", "[", "i", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Is", "=", 
    RowBox[{"{", 
     RowBox[{"0", ",", "1", ",", "2", ",", "3", ",", "5", ",", "6"}], "}"}]}],
    ";"}], 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"or", " ", "0"}], "-", "based"}], ",", 
    RowBox[{"adjust", " ", "indexing", " ", "if", " ", "needed"}]}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"rhoIn", "=", 
    RowBox[{"Total", "[", 
     RowBox[{"pop", "/@", "Is"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"cx", "=", 
   RowBox[{"{", 
    RowBox[{"0", ",", "1", ",", "0", ",", 
     RowBox[{"-", "1"}], ",", "0", ",", "1", ",", 
     RowBox[{"-", "1"}], ",", 
     RowBox[{"-", "1"}], ",", "1"}], "}"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"cy", "=", 
    RowBox[{"{", 
     RowBox[{"0", ",", "0", ",", "1", ",", "0", ",", 
      RowBox[{"-", "1"}], ",", "1", ",", "1", ",", 
      RowBox[{"-", "1"}], ",", 
      RowBox[{"-", "1"}]}], "}"}]}], ";"}], "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"HxxI", "[", "i_", "]"}], ":=", 
   RowBox[{
    RowBox[{"cx", "[", 
     RowBox[{"[", 
      RowBox[{"i", "+", "1"}], "]"}], "]"}], "^", "2"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"HyyI", "[", "i_", "]"}], ":=", 
   RowBox[{
    RowBox[{"cy", "[", 
     RowBox[{"[", 
      RowBox[{"i", "+", "1"}], "]"}], "]"}], "^", "2"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"HxyI", "[", "i_", "]"}], ":=", 
    RowBox[{
     RowBox[{"cx", "[", 
      RowBox[{"[", 
       RowBox[{"i", "+", "1"}], "]"}], "]"}], "*", 
     RowBox[{"cy", "[", 
      RowBox[{"[", 
       RowBox[{"i", "+", "1"}], "]"}], "]"}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{"MxxIn", "=", 
   RowBox[{"Total", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"pop", "[", "#", "]"}], "*", 
       RowBox[{"HxxI", "[", "#", "]"}]}], "&"}], "/@", "Is"}], "]"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{"MyyIn", "=", 
   RowBox[{"Total", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"pop", "[", "#", "]"}], "*", 
       RowBox[{"HyyI", "[", "#", "]"}]}], "&"}], "/@", "Is"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MxyIn", "=", 
    RowBox[{"Total", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"pop", "[", "#", "]"}], "*", 
        RowBox[{"HxyI", "[", "#", "]"}]}], "&"}], "/@", "Is"}], "]"}]}], 
   ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"Row", "[", 
  RowBox[{"{", 
   RowBox[{
   "\"\<rhoI = \>\"", " ", ",", "\"\<(\>\"", ",", "rhoIn", ",", "\"\<)\>\""}],
    "}"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Row", "[", 
  RowBox[{"{", "\"\<inv_rhoI = 1.0/rhoI \>\"", " ", "}"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"Row", "[", 
  RowBox[{"{", 
   RowBox[{
   "\"\<mxxI = \>\"", " ", ",", "\"\<(\>\"", ",", "MxxIn", ",", "\"\<)\>\"", 
    ",", "\"\<*\>\"", ",", "\"\< inv_rhoI \>\"", ",", "\"\< - \>\"", ",", 
    "\"\<cs2\>\""}], "}"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Row", "[", 
  RowBox[{"{", 
   RowBox[{
   "\"\<myyI = \>\"", " ", ",", "\"\<(\>\"", ",", "MyyIn", ",", "\"\<)\>\"", 
    ",", "\"\<*\>\"", ",", "\"\< inv_rhoI \>\"", ",", "\"\< - \>\"", ",", 
    "\"\<cs2\>\""}], "}"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Row", "[", 
  RowBox[{"{", 
   RowBox[{
   "\"\<mxyI = \>\"", " ", ",", "\"\<(\>\"", ",", "MxyIn", ",", "\"\<)\>\"", 
    ",", "\"\<*\>\"", ",", "\"\< inv_rhoI \>\""}], "}"}], "]"}]}], "Input",
 CellChangeTimes->{{3.962357613310965*^9, 3.962357622144897*^9}, {
  3.9623576549317513`*^9, 3.962357730256467*^9}, {3.9623577890906553`*^9, 
  3.962357993902472*^9}, {3.962358073264195*^9, 3.962358152510972*^9}, {
  3.962364347935895*^9, 3.962364355413341*^9}},
 CellLabel->"In[33]:=",ExpressionUUID->"1149ee70-a5c9-46bc-b1d8-e9713d328330"],

Cell[BoxData[
 TemplateBox[{"\"rhoI = \"","\"(\"",RowBox[{
     RowBox[{"pop", "[", "0", "]"}], "+", 
     RowBox[{"pop", "[", "1", "]"}], "+", 
     RowBox[{"pop", "[", "2", "]"}], "+", 
     RowBox[{"pop", "[", "3", "]"}], "+", 
     RowBox[{"pop", "[", "5", "]"}], "+", 
     RowBox[{"pop", "[", "6", "]"}]}],"\")\""},
  "RowDefault"]], "Output",
 CellChangeTimes->{{3.962357614924369*^9, 3.9623576792324553`*^9}, {
   3.962357712118181*^9, 3.962357731232048*^9}, 3.962357791647595*^9, {
   3.962357838828455*^9, 3.962357963204896*^9}, 3.9623580757549677`*^9, {
   3.9623581145407343`*^9, 3.9623581474826202`*^9}, {3.962364331947205*^9, 
   3.962364355930769*^9}},
 CellLabel->"Out[44]=",ExpressionUUID->"e3de7fdf-bfac-4d12-a0cc-00c80a9f063a"],

Cell[BoxData[
 TemplateBox[{"\"inv_rhoI = 1.0/rhoI \""},
  "RowDefault"]], "Output",
 CellChangeTimes->{{3.962357614924369*^9, 3.9623576792324553`*^9}, {
   3.962357712118181*^9, 3.962357731232048*^9}, 3.962357791647595*^9, {
   3.962357838828455*^9, 3.962357963204896*^9}, 3.9623580757549677`*^9, {
   3.9623581145407343`*^9, 3.9623581474826202`*^9}, {3.962364331947205*^9, 
   3.9623643559355707`*^9}},
 CellLabel->"Out[45]=",ExpressionUUID->"1965baa3-6494-4b70-977a-093f8a27496d"],

Cell[BoxData[
 TemplateBox[{"\"mxxI = \"","\"(\"",RowBox[{
     RowBox[{"pop", "[", "1", "]"}], "+", 
     RowBox[{"pop", "[", "3", "]"}], "+", 
     RowBox[{"pop", "[", "5", "]"}], "+", 
     RowBox[{"pop", "[", "6", "]"}]}],"\")\"","\"*\"","\" inv_rhoI \"",
   "\" - \"","\"cs2\""},
  "RowDefault"]], "Output",
 CellChangeTimes->{{3.962357614924369*^9, 3.9623576792324553`*^9}, {
   3.962357712118181*^9, 3.962357731232048*^9}, 3.962357791647595*^9, {
   3.962357838828455*^9, 3.962357963204896*^9}, 3.9623580757549677`*^9, {
   3.9623581145407343`*^9, 3.9623581474826202`*^9}, {3.962364331947205*^9, 
   3.962364355938561*^9}},
 CellLabel->"Out[46]=",ExpressionUUID->"7ede941f-88f1-4e6b-95c9-455e129365aa"],

Cell[BoxData[
 TemplateBox[{"\"myyI = \"","\"(\"",RowBox[{
     RowBox[{"pop", "[", "2", "]"}], "+", 
     RowBox[{"pop", "[", "5", "]"}], "+", 
     RowBox[{"pop", "[", "6", "]"}]}],"\")\"","\"*\"","\" inv_rhoI \"",
   "\" - \"","\"cs2\""},
  "RowDefault"]], "Output",
 CellChangeTimes->{{3.962357614924369*^9, 3.9623576792324553`*^9}, {
   3.962357712118181*^9, 3.962357731232048*^9}, 3.962357791647595*^9, {
   3.962357838828455*^9, 3.962357963204896*^9}, 3.9623580757549677`*^9, {
   3.9623581145407343`*^9, 3.9623581474826202`*^9}, {3.962364331947205*^9, 
   3.962364355942686*^9}},
 CellLabel->"Out[47]=",ExpressionUUID->"f35bb774-8021-4fd1-bfb7-1407be439929"],

Cell[BoxData[
 TemplateBox[{"\"mxyI = \"","\"(\"",RowBox[{
     RowBox[{"pop", "[", "5", "]"}], "-", 
     RowBox[{"pop", "[", "6", "]"}]}],"\")\"","\"*\"","\" inv_rhoI \""},
  "RowDefault"]], "Output",
 CellChangeTimes->{{3.962357614924369*^9, 3.9623576792324553`*^9}, {
   3.962357712118181*^9, 3.962357731232048*^9}, 3.962357791647595*^9, {
   3.962357838828455*^9, 3.962357963204896*^9}, 3.9623580757549677`*^9, {
   3.9623581145407343`*^9, 3.9623581474826202`*^9}, {3.962364331947205*^9, 
   3.9623643559467077`*^9}},
 CellLabel->"Out[48]=",ExpressionUUID->"232de942-8779-45a0-8117-b82b3f388d3e"]
}, Open  ]]
},
WindowSize->{1854, 1003},
WindowMargins->{{Automatic, 0}, {0, Automatic}},
Magnification:>1.5 Inherited,
FrontEndVersion->"12.0 for Linux x86 (64-bit) (April 8, 2019)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 4041, 121, 694, "Input",ExpressionUUID->"1149ee70-a5c9-46bc-b1d8-e9713d328330"],
Cell[4624, 145, 746, 14, 74, "Output",ExpressionUUID->"e3de7fdf-bfac-4d12-a0cc-00c80a9f063a"],
Cell[5373, 161, 483, 8, 74, "Output",ExpressionUUID->"1965baa3-6494-4b70-977a-093f8a27496d"],
Cell[5859, 171, 709, 13, 74, "Output",ExpressionUUID->"7ede941f-88f1-4e6b-95c9-455e129365aa"],
Cell[6571, 186, 666, 12, 74, "Output",ExpressionUUID->"f35bb774-8021-4fd1-bfb7-1407be439929"],
Cell[7240, 200, 601, 10, 74, "Output",ExpressionUUID->"232de942-8779-45a0-8117-b82b3f388d3e"]
}, Open  ]]
}
]
*)

