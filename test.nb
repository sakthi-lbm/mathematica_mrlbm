(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     12779,        383]
NotebookOptionsPosition[     11948,        362]
NotebookOutlinePosition[     12312,        378]
CellTagsIndexPosition[     12269,        375]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "Properties", " ", "of", " ", "D2Q9", " ", "lattice", " ", "stencils"}], 
   "*)"}], 
  RowBox[{
   RowBox[{
    RowBox[{"w", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"4", "/", "9"}], ",", 
       RowBox[{"1", "/", "9"}], ",", 
       RowBox[{"1", "/", "9"}], ",", 
       RowBox[{"1", "/", "9"}], ",", 
       RowBox[{"1", "/", "9"}], ",", 
       RowBox[{"1", "/", "36"}], ",", 
       RowBox[{"1", "/", "36"}], ",", 
       RowBox[{"1", "/", "36"}], ",", 
       RowBox[{"1", "/", "36"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
   "\n", 
   RowBox[{
    RowBox[{"cx", "=", 
     RowBox[{"{", 
      RowBox[{"0", ",", "1", ",", "0", ",", 
       RowBox[{"-", "1"}], ",", "0", ",", "1", ",", 
       RowBox[{"-", "1"}], ",", 
       RowBox[{"-", "1"}], ",", "1"}], "}"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"cy", "=", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "1", ",", "0", ",", 
       RowBox[{"-", "1"}], ",", "1", ",", "1", ",", 
       RowBox[{"-", "1"}], ",", 
       RowBox[{"-", "1"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"Hxx", "[", "i_", "]"}], ":=", 
     RowBox[{
      RowBox[{"cx", "[", 
       RowBox[{"[", "i", "]"}], "]"}], "^", "2"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"Hyy", "[", "i_", "]"}], ":=", 
     RowBox[{
      RowBox[{"cy", "[", 
       RowBox[{"[", "i", "]"}], "]"}], "^", "2"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"Hxy", "[", "i_", "]"}], ":=", 
     RowBox[{
      RowBox[{"cx", "[", 
       RowBox[{"[", "i", "]"}], "]"}], "*", 
      RowBox[{"cy", "[", 
       RowBox[{"[", "i", "]"}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"distribution", " ", "functions"}], "*)"}], 
   RowBox[{
    RowBox[{
     RowBox[{"f", "[", "i_", "]"}], ":=", 
     RowBox[{"\[Rho]", "*", 
      RowBox[{"w", "[", 
       RowBox[{"[", "i", "]"}], "]"}], "*", 
      RowBox[{"(", 
       RowBox[{"1", "+", 
        RowBox[{"3", "*", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"ux", "*", 
            RowBox[{"cx", "[", 
             RowBox[{"[", "i", "]"}], "]"}]}], "+", 
           RowBox[{"uy", "*", 
            RowBox[{"cy", "[", 
             RowBox[{"[", "i", "]"}], "]"}]}]}], ")"}]}], "+", 
        RowBox[{"9", "*", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"mxx", "*", 
             RowBox[{"Hxx", "[", "i", "]"}]}], "+", 
            RowBox[{"myy", "*", 
             RowBox[{"Hyy", "[", "i", "]"}]}], "+", 
            RowBox[{"2", "*", "mxy", "*", 
             RowBox[{"Hxy", "[", "i", "]"}]}]}], ")"}], "/", "2"}]}]}], 
       ")"}]}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"feq", "[", "i_", "]"}], ":=", 
     RowBox[{"\[Rho]", "*", 
      RowBox[{"w", "[", 
       RowBox[{"[", "i", "]"}], "]"}], "*", 
      RowBox[{"(", 
       RowBox[{"1", "+", 
        RowBox[{"3", "*", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"ux", "*", 
            RowBox[{"cx", "[", 
             RowBox[{"[", "i", "]"}], "]"}]}], "+", 
           RowBox[{"uy", "*", 
            RowBox[{"cy", "[", 
             RowBox[{"[", "i", "]"}], "]"}]}]}], ")"}]}], "+", 
        RowBox[{"9", "*", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"ux", "*", "ux", "*", 
             RowBox[{"Hxx", "[", "i", "]"}]}], "+", 
            RowBox[{"uy", "*", "uy", "*", 
             RowBox[{"Hyy", "[", "i", "]"}]}], "+", 
            RowBox[{"2", "*", "ux", "*", "uy", "*", 
             RowBox[{"Hxy", "[", "i", "]"}]}]}], ")"}], "/", "2"}]}]}], 
       ")"}]}]}], ";"}], "\n", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Is", " ", "=", " ", 
     RowBox[{"{", 
      RowBox[{"0", ",", "2", ",", "3", ",", "4", ",", "6", ",", "7"}], 
      "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Os", " ", "=", " ", 
     RowBox[{"{", 
      RowBox[{"0", ",", "1", ",", "2", ",", "4", ",", "5", ",", "8"}], 
      "}"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Is", " ", "=", " ", 
     RowBox[{"{", 
      RowBox[{"0", ",", "1", ",", "2", ",", "4", ",", "5", ",", "8"}], 
      "}"}]}], ";"}], " ", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Os", " ", "=", " ", 
     RowBox[{"{", 
      RowBox[{"0", ",", "1", ",", "3", ",", "4", ",", "7", ",", "8"}], 
      "}"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Is", " ", "=", " ", 
     RowBox[{"{", 
      RowBox[{"0", ",", "1", ",", "2", ",", "3", ",", "5", ",", "6"}], 
      "}"}]}], ";"}], " ", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Os", " ", "=", " ", 
     RowBox[{"{", 
      RowBox[{"0", ",", "1", ",", "3", ",", "4", ",", "7", ",", "8"}], 
      "}"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Bounadry", " ", "Equations"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"eqrhoS", "=", 
     RowBox[{
      RowBox[{
       RowBox[{"Simplify", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"1", "-", "omega"}], ")"}], "*", 
          RowBox[{"Total", "[", 
           RowBox[{"f", "[", 
            RowBox[{"Os", "+", "1"}], "]"}], "]"}]}], "+", 
         RowBox[{"omega", "*", 
          RowBox[{"Total", "[", 
           RowBox[{"feq", "[", 
            RowBox[{"Os", "+", "1"}], "]"}], "]"}]}]}], "]"}], "-", "rhoI"}], 
      "\[Equal]", "0"}]}], ";"}], "\n", 
   RowBox[{"eqrhoW", "=", 
    RowBox[{
     RowBox[{
      RowBox[{"Simplify", "[", 
       RowBox[{"Total", "[", 
        RowBox[{"f", "[", 
         RowBox[{"Is", "+", "1"}], "]"}], "]"}], "]"}], "-", "rhoI"}], 
     "\[Equal]", "0"}]}], "\n", 
   RowBox[{
    RowBox[{"eqrhoEq", "=", 
     RowBox[{
      RowBox[{
       RowBox[{"Simplify", "[", 
        RowBox[{"Total", "[", 
         RowBox[{"feq", "[", 
          RowBox[{"Os", "+", "1"}], "]"}], "]"}], "]"}], "-", "rhoI"}], 
      "\[Equal]", "0"}]}], ";"}], "\n", 
   RowBox[{"equx", "=", 
    RowBox[{
     RowBox[{
      RowBox[{"Simplify", "[", 
       RowBox[{"Total", "[", 
        RowBox[{
         RowBox[{"f", "[", 
          RowBox[{"Is", "+", "1"}], "]"}], "*", 
         RowBox[{"cx", "[", 
          RowBox[{"[", 
           RowBox[{"Is", "+", "1"}], "]"}], "]"}]}], "]"}], "]"}], "-", 
      RowBox[{"rhoI", "*", "uxI"}]}], "\[Equal]", "0"}]}], "\n", 
   RowBox[{"equy", "=", 
    RowBox[{
     RowBox[{
      RowBox[{"Simplify", "[", 
       RowBox[{"Total", "[", 
        RowBox[{
         RowBox[{"f", "[", 
          RowBox[{"Is", "+", "1"}], "]"}], "*", 
         RowBox[{"cy", "[", 
          RowBox[{"[", 
           RowBox[{"Is", "+", "1"}], "]"}], "]"}]}], "]"}], "]"}], "-", 
      RowBox[{"rhoI", "*", "uyI"}]}], "\[Equal]", "0"}]}], "\n", 
   RowBox[{"eqmxx", "=", 
    RowBox[{
     RowBox[{
      RowBox[{"Simplify", "[", 
       RowBox[{"Total", "[", 
        RowBox[{
         RowBox[{"f", "[", 
          RowBox[{"Is", "+", "1"}], "]"}], "*", 
         RowBox[{"Hxx", "[", 
          RowBox[{"Is", "+", "1"}], "]"}]}], "]"}], "]"}], "-", 
      RowBox[{"rhoI", "*", "mxxI"}]}], "\[Equal]", "0"}]}], "\n", 
   RowBox[{"eqmyy", "=", 
    RowBox[{
     RowBox[{
      RowBox[{"Simplify", "[", 
       RowBox[{"Total", "[", 
        RowBox[{
         RowBox[{"f", "[", 
          RowBox[{"Is", "+", "1"}], "]"}], "*", 
         RowBox[{"Hyy", "[", 
          RowBox[{"Is", "+", "1"}], "]"}]}], "]"}], "]"}], "-", 
      RowBox[{"rhoI", "*", "myyI"}]}], "\[Equal]", "0"}]}], "\n", 
   RowBox[{
    RowBox[{"eqmxy", "=", 
     RowBox[{
      RowBox[{
       RowBox[{"Simplify", "[", 
        RowBox[{"Total", "[", 
         RowBox[{
          RowBox[{"f", "[", 
           RowBox[{"Is", "+", "1"}], "]"}], "*", 
          RowBox[{"Hxy", "[", 
           RowBox[{"Is", "+", "1"}], "]"}]}], "]"}], "]"}], "-", 
       RowBox[{"rhoI", "*", "mxyI"}]}], "\[Equal]", "0"}]}], 
    ";"}]}]}]], "Input",
 CellChangeTimes->{{3.961774164717861*^9, 3.961774228221856*^9}, {
  3.96177430012964*^9, 3.961774359459737*^9}, {3.961774414481605*^9, 
  3.961774419593567*^9}},
 CellLabel->
  "In[567]:=",ExpressionUUID->"2e419355-ad4c-4d9e-8028-7cb0d7797ea5"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"-", "rhoI"}], "+", 
   RowBox[{
    FractionBox["1", "12"], " ", 
    RowBox[{"(", 
     RowBox[{"10", "+", 
      RowBox[{"15", " ", "mxx"}], "+", 
      RowBox[{"9", " ", "myy"}], "+", 
      RowBox[{"6", " ", "uy"}]}], ")"}], " ", "\[Rho]"}]}], "\[Equal]", 
  "0"}]], "Output",
 CellChangeTimes->{{3.961774215620987*^9, 3.9617742290629168`*^9}, 
   3.961774302265616*^9, {3.961774332962183*^9, 3.9617743603319683`*^9}, 
   3.961774420790906*^9},
 CellLabel->
  "Out[582]=",ExpressionUUID->"3c42ee90-a372-4076-bc14-eecd9b4567e3"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"-", "rhoI"}], " ", "uxI"}], "+", 
   RowBox[{
    FractionBox["1", "6"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"3", " ", "mxy"}], "+", 
      RowBox[{"5", " ", "ux"}]}], ")"}], " ", "\[Rho]"}]}], "\[Equal]", 
  "0"}]], "Output",
 CellChangeTimes->{{3.961774215620987*^9, 3.9617742290629168`*^9}, 
   3.961774302265616*^9, {3.961774332962183*^9, 3.9617743603319683`*^9}, 
   3.961774420825822*^9},
 CellLabel->
  "Out[584]=",ExpressionUUID->"10723f2b-0225-4c84-8902-95cf4a2be78d"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"-", "rhoI"}], " ", "uyI"}], "+", 
   RowBox[{
    FractionBox["1", "12"], " ", 
    RowBox[{"(", 
     RowBox[{"2", "+", 
      RowBox[{"3", " ", "mxx"}], "+", 
      RowBox[{"9", " ", "myy"}], "+", 
      RowBox[{"6", " ", "uy"}]}], ")"}], " ", "\[Rho]"}]}], "\[Equal]", 
  "0"}]], "Output",
 CellChangeTimes->{{3.961774215620987*^9, 3.9617742290629168`*^9}, 
   3.961774302265616*^9, {3.961774332962183*^9, 3.9617743603319683`*^9}, 
   3.961774420828268*^9},
 CellLabel->
  "Out[585]=",ExpressionUUID->"3631ac7d-03e7-4bc9-a4ac-3867cba0fa4a"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"-", "mxxI"}], " ", "rhoI"}], "+", 
   RowBox[{
    FractionBox["1", "36"], " ", 
    RowBox[{"(", 
     RowBox[{"10", "+", 
      RowBox[{"45", " ", "mxx"}], "+", 
      RowBox[{"9", " ", "myy"}], "+", 
      RowBox[{"6", " ", "uy"}]}], ")"}], " ", "\[Rho]"}]}], "\[Equal]", 
  "0"}]], "Output",
 CellChangeTimes->{{3.961774215620987*^9, 3.9617742290629168`*^9}, 
   3.961774302265616*^9, {3.961774332962183*^9, 3.9617743603319683`*^9}, 
   3.961774420830229*^9},
 CellLabel->
  "Out[586]=",ExpressionUUID->"9836d6e2-11ee-41f1-9792-c6033fae05a6"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"-", "myyI"}], " ", "rhoI"}], "+", 
   RowBox[{
    FractionBox["1", "12"], " ", 
    RowBox[{"(", 
     RowBox[{"2", "+", 
      RowBox[{"3", " ", "mxx"}], "+", 
      RowBox[{"9", " ", "myy"}], "+", 
      RowBox[{"6", " ", "uy"}]}], ")"}], " ", "\[Rho]"}]}], "\[Equal]", 
  "0"}]], "Output",
 CellChangeTimes->{{3.961774215620987*^9, 3.9617742290629168`*^9}, 
   3.961774302265616*^9, {3.961774332962183*^9, 3.9617743603319683`*^9}, 
   3.9617744208332033`*^9},
 CellLabel->
  "Out[587]=",ExpressionUUID->"f5fe87c7-8763-4c65-bf18-cbb14e57db16"]
}, Open  ]]
},
WindowSize->{1854, 1003},
WindowMargins->{{Automatic, 0}, {0, Automatic}},
Magnification:>1.3 Inherited,
FrontEndVersion->"12.0 for Linux x86 (64-bit) (April 8, 2019)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 8391, 244, 1067, "Input",ExpressionUUID->"2e419355-ad4c-4d9e-8028-7cb0d7797ea5"],
Cell[8974, 268, 578, 16, 86, "Output",ExpressionUUID->"3c42ee90-a372-4076-bc14-eecd9b4567e3"],
Cell[9555, 286, 553, 16, 119, "Output",ExpressionUUID->"10723f2b-0225-4c84-8902-95cf4a2be78d"],
Cell[10111, 304, 603, 17, 86, "Output",ExpressionUUID->"3631ac7d-03e7-4bc9-a4ac-3867cba0fa4a"],
Cell[10717, 323, 606, 17, 86, "Output",ExpressionUUID->"9836d6e2-11ee-41f1-9792-c6033fae05a6"],
Cell[11326, 342, 606, 17, 86, "Output",ExpressionUUID->"f5fe87c7-8763-4c65-bf18-cbb14e57db16"]
}, Open  ]]
}
]
*)

